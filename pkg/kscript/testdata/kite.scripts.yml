# mode: top_config, setting
#__xfile_mode: setting
__setting:
  vars: # built in group name. access: ${vars.xxx}
    var01: test value
    var02: test value2
  groups: # grouped vars
    dev: # group name: dev
      var01: 'value in dev'
    prod:
      var01: 'value in prod'
  env:
    KEY: value
  # add env path values.
  env_path:
    - add/new/path
    - add/new/path1
  dotenv: [ '.env' ]
  output: 'group'

echo: echo hi
demo:
  - bash -c 'echo $SHELL'
  - echo $SHELL
  - echo hello

# will exec command in type shell
demo-with-type:
  type: bash
  cmds:
    - echo $SHELL # will exec `bash -c "echo $SHELL"`
    - echo hello

demo-with-env:
  env:
    MY_TEST_KEY: custom env value
  cmds:
    - echo $SHELL
    - echo $MY_TEST_KEY

demo-cmd: echo "hello, at demo-cmd"

demo-ref-task:
  cmds:
    - task: demo-cmd
    - echo "hello, at demo-ref-task"

# 使用 动态变量
demo-use-dynamic-var:
  cmds:
    - go build -ldflags="-X main.Version=$GIT_COMMIT" main.go
  vars:
    name: value
    GO_VERSION: "@exec: go version"
    GIT_BRANCH: "@sh: git branch -a"
    GIT_COMMIT: "@sh: git log -n 1 --format=%h"

# task 可以自定义追加 env path
update-env-path:
  env_path:
    - add/new/path1/in-task
  cmd: echo $PATH

# task 添加变量
demo-task-vars:
  vars:
    name: value
  cmd: echo $name

# 每个子命令都可以定义 vars，workdir 等
adv-task-cmds:
  vars:
    name: tom
    key1: value1
  cmds:
    - run: echo $name, $key1
      dir: $HOME
    - run: echo hi $name, $key1
      vars:
        name: jack
        key1: value2



